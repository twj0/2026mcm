# Q3 å¯è§†åŒ–è§„åˆ’æ–‡æ¡£ï¼šå½±å“å› ç´ åˆ†æä¸æŠ€æœ¯-äººæ°”çº¿å¯¹æ¯”

**ç›®æ ‡**: é€šè¿‡å¯è§†åŒ–å±•ç¤ºQ3çš„æ ¸å¿ƒè´¡çŒ®â€”â€”è¯†åˆ«å½±å“æŠ€æœ¯è¡¨ç°å’Œäººæ°”è¡¨ç°çš„ä¸åŒå› ç´ ï¼Œæ­ç¤ºä¸¤æ¡è¯„ä»·çº¿çš„å·®å¼‚æœºåˆ¶

## ğŸ“Š **æ ¸å¿ƒå¯è§†åŒ–ç›®æ ‡**

### 1. **æŠ€æœ¯vsäººæ°”å¯¹æ¯”**: ç›´è§‚å±•ç¤ºåŒä¸€å› ç´ åœ¨æŠ€æœ¯çº¿å’Œäººæ°”çº¿ä¸Šçš„ä¸åŒå½±å“
### 2. **å…³é”®å› ç´ è¯†åˆ«**: çªå‡ºæ˜¾ç¤ºæœ€é‡è¦çš„å½±å“å› ç´ åŠå…¶æ•ˆåº”å¤§å°
### 3. **ä¸ç¡®å®šæ€§ä¼ æ’­**: å±•ç¤ºQ1ä¸ç¡®å®šæ€§å¦‚ä½•å½±å“Q3çš„ç³»æ•°ä¼°è®¡
### 4. **æ¨¡å‹éªŒè¯**: é€šè¿‡ç‚«æŠ€å¯¹æ¯”éªŒè¯æ··åˆæ•ˆåº”æ¨¡å‹çš„ä¼˜åŠ¿

---

## âœ… ä¸»çº¿å£å¾„çº¦æŸï¼ˆå†™è¿›è®ºæ–‡æ­£æ–‡å¿…é¡»éµå®ˆï¼‰

- **ä¸»çº¿å›¾è¡¨**åªå…è®¸ä½¿ç”¨ï¼š
  - `data/processed/*.csv`
  - `outputs/tables/*.csv`
  - `outputs/predictions/*.csv`
- `outputs/tables/showcase/*` ä»…ç”¨äº**é™„å½•å¯¹ç…§/ç‚«æŠ€**ã€‚

## ğŸ¯ **ä¸»çº¿å›¾è¡¨æ¸…å•**

### å›¾3-1: æŠ€æœ¯çº¿vsäººæ°”çº¿ç³»æ•°å¯¹æ¯”æ£®æ—å›¾ (Judge vs Fan Coefficients Forest Plot)
**æ–‡ä»¶å**: `q3_judge_vs_fan_forest_plot.{tiff,eps}`

**ç›®çš„**: æ ¸å¿ƒå›¾è¡¨ï¼Œç›´è§‚å¯¹æ¯”åŒä¸€å› ç´ åœ¨æŠ€æœ¯çº¿å’Œäººæ°”çº¿ä¸Šçš„ä¸åŒå½±å“

**æ•°æ®æº**: 
- `outputs/tables/mcm2026c_q3_impact_analysis_coeffs.csv`
- å­—æ®µ: `outcome, term, estimate, ci_low, ci_high, p_value`

**å›¾è¡¨è®¾è®¡**:
```python
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(18, 12), sharey=True)

# ç­›é€‰å…³é”®å˜é‡ï¼ˆæ’é™¤æˆªè·å’Œä¸é‡è¦çš„ç±»åˆ«å˜é‡ï¼‰
key_terms = ['age', 'age_sq', 'is_us', 'log_state_pop', 'n_weeks_active', 
            'C(industry)[T.Actor]', 'C(industry)[T.Athlete]', 'C(industry)[T.Singer]']

# å·¦å›¾: æŠ€æœ¯çº¿ (judge_score_pct_mean)
judge_data = coeffs[coeffs['outcome'] == 'judge_score_pct_mean']
judge_key = judge_data[judge_data['term'].isin(key_terms)].sort_values('estimate')

y_pos = np.arange(len(judge_key))
ax1.errorbar(judge_key['estimate'], y_pos, 
            xerr=[judge_key['estimate'] - judge_key['ci_low'],
                  judge_key['ci_high'] - judge_key['estimate']],
            fmt='o', capsize=5, capthick=2, color='steelblue', markersize=8)

# æ·»åŠ æ˜¾è‘—æ€§æ ‡è®°
for i, (_, row) in enumerate(judge_key.iterrows()):
    if row['p_value'] < 0.001:
        ax1.text(row['ci_high'] + 0.01, i, '***', va='center', fontweight='bold')
    elif row['p_value'] < 0.01:
        ax1.text(row['ci_high'] + 0.01, i, '**', va='center', fontweight='bold')
    elif row['p_value'] < 0.05:
        ax1.text(row['ci_high'] + 0.01, i, '*', va='center', fontweight='bold')

ax1.axvline(x=0, color='red', linestyle='--', alpha=0.7)
ax1.set_yticks(y_pos)
ax1.set_yticklabels([term.replace('C(industry)[T.', '').replace(']', '') 
                    for term in judge_key['term']])
ax1.set_xlabel('ç³»æ•°ä¼°è®¡å€¼')
ax1.set_title('æŠ€æœ¯çº¿å½±å“å› ç´ \n(è¯„å§”åˆ†æ•°ç™¾åˆ†ä½)', fontsize=14, fontweight='bold')
ax1.grid(True, alpha=0.3)

# å³å›¾: äººæ°”çº¿ (fan_vote_index_mean) - ç±»ä¼¼è®¾è®¡
fan_data = coeffs[coeffs['outcome'] == 'fan_vote_index_mean']
fan_key = fan_data[fan_data['term'].isin(key_terms)].sort_values('estimate')

# ... ç±»ä¼¼çš„ç»˜å›¾ä»£ç  ...
ax2.set_xlabel('ç³»æ•°ä¼°è®¡å€¼')
ax2.set_title('äººæ°”çº¿å½±å“å› ç´ \n(ç²‰ä¸æŠ•ç¥¨æŒ‡æ•°)', fontsize=14, fontweight='bold')

plt.tight_layout()
```

**å…³é”®è§£è¯»ç‚¹**:
- `is_us`åœ¨äººæ°”çº¿ä¸Šæ˜¾è‘—æ›´å¼ºï¼ˆæœ¬åœŸä¼˜åŠ¿ï¼‰
- `age`åœ¨ä¸¤æ¡çº¿ä¸Šæ–¹å‘å¯èƒ½ä¸åŒï¼ˆå¹´é¾„æ•ˆåº”å·®å¼‚ï¼‰
- èŒä¸šç±»åˆ«åœ¨æŠ€æœ¯vsäººæ°”ä¸Šçš„ä¸åŒå½±å“æ¨¡å¼
- ç½®ä¿¡åŒºé—´å®½åº¦åæ˜ ä¼°è®¡çš„ä¸ç¡®å®šæ€§

---

### å›¾3-2: å…³é”®å› ç´ æ•ˆåº”å¤§å°å¯¹æ¯”å›¾ (Key Factors Effect Size Comparison)
**æ–‡ä»¶å**: `q3_effect_size_comparison.{tiff,eps}`

**ç›®çš„**: çªå‡ºæ˜¾ç¤ºæœ€é‡è¦çš„å½±å“å› ç´ ï¼Œä¾¿äºæ”¿ç­–åˆ¶å®šè€…ç†è§£

**æ•°æ®æº**:
- åŒä¸Šï¼Œä½†é‡ç‚¹å±•ç¤ºæ•ˆåº”å¤§å°æœ€å¤§çš„å› ç´ 

**å›¾è¡¨è®¾è®¡**:
```python
fig, ax = plt.subplots(figsize=(14, 10))

# è®¡ç®—æ ‡å‡†åŒ–æ•ˆåº”å¤§å°
judge_effects = judge_key.set_index('term')['estimate']
fan_effects = fan_key.set_index('term')['estimate']

# é€‰æ‹©å…±åŒçš„å…³é”®å› ç´ 
common_terms = list(set(judge_effects.index) & set(fan_effects.index))
x = np.arange(len(common_terms))
width = 0.35

# å¹¶åˆ—æŸ±çŠ¶å›¾
bars1 = ax.bar(x - width/2, [judge_effects[term] for term in common_terms], 
               width, label='æŠ€æœ¯çº¿', color='steelblue', alpha=0.8)
bars2 = ax.bar(x + width/2, [fan_effects[term] for term in common_terms], 
               width, label='äººæ°”çº¿', color='lightcoral', alpha=0.8)

# æ·»åŠ æ•°å€¼æ ‡ç­¾
for i, (bar1, bar2) in enumerate(zip(bars1, bars2)):
    height1 = bar1.get_height()
    height2 = bar2.get_height()
    ax.text(bar1.get_x() + bar1.get_width()/2., height1 + 0.01,
           f'{height1:.3f}', ha='center', va='bottom', fontsize=10)
    ax.text(bar2.get_x() + bar2.get_width()/2., height2 + 0.01,
           f'{height2:.3f}', ha='center', va='bottom', fontsize=10)

ax.set_xlabel('å½±å“å› ç´ ')
ax.set_ylabel('æ ‡å‡†åŒ–ç³»æ•°')
ax.set_title('å…³é”®å› ç´ åœ¨æŠ€æœ¯çº¿vsäººæ°”çº¿çš„æ•ˆåº”å¯¹æ¯”')
ax.set_xticks(x)
ax.set_xticklabels([term.replace('C(industry)[T.', '').replace(']', '') 
                   for term in common_terms], rotation=45, ha='right')
ax.legend()
ax.axhline(y=0, color='black', linestyle='-', alpha=0.3)
ax.grid(True, alpha=0.3)
```

**å…³é”®è§£è¯»ç‚¹**:
- ç›´è§‚å¯¹æ¯”åŒä¸€å› ç´ çš„åŒé‡æ•ˆåº”
- è¯†åˆ«"æŠ€æœ¯å‹å¥½"vs"äººæ°”å‹å¥½"çš„å› ç´ 
- ä¸ºé€‰æ‰‹ç­–ç•¥å’Œåˆ¶ä½œæ–¹å†³ç­–æä¾›ä¾æ®

---

### å›¾3-3: å¹´é¾„æ•ˆåº”æ›²çº¿å›¾ (Age Effect Curves)
**æ–‡ä»¶å**: `q3_age_effect_curves.{tiff,eps}`

**ç›®çš„**: å±•ç¤ºå¹´é¾„çš„éçº¿æ€§æ•ˆåº”ï¼Œè§£é‡Šå¹´é¾„å¹³æ–¹é¡¹çš„å¿…è¦æ€§

**æ•°æ®æº**:
- ä½¿ç”¨Q3ç³»æ•°é‡æ„å¹´é¾„æ•ˆåº”æ›²çº¿
- `age`å’Œ`age_sq`ç³»æ•°

**å›¾è¡¨è®¾è®¡**:
```python
fig, ax = plt.subplots(figsize=(12, 8))

# ä»ç³»æ•°é‡æ„å¹´é¾„æ•ˆåº”
age_range = np.linspace(18, 65, 100)

# æŠ€æœ¯çº¿å¹´é¾„æ•ˆåº”
judge_age_coef = judge_data[judge_data['term'] == 'age']['estimate'].iloc[0]
judge_age_sq_coef = judge_data[judge_data['term'] == 'age_sq']['estimate'].iloc[0]
judge_age_effect = judge_age_coef * age_range + judge_age_sq_coef * (age_range ** 2)

# äººæ°”çº¿å¹´é¾„æ•ˆåº”
fan_age_coef = fan_data[fan_data['term'] == 'age']['estimate'].iloc[0]
fan_age_sq_coef = fan_data[fan_data['term'] == 'age_sq']['estimate'].iloc[0]
fan_age_effect = fan_age_coef * age_range + fan_age_sq_coef * (age_range ** 2)

# ç»˜åˆ¶æ›²çº¿
ax.plot(age_range, judge_age_effect, 'b-', linewidth=3, label='æŠ€æœ¯çº¿', alpha=0.8)
ax.plot(age_range, fan_age_effect, 'r-', linewidth=3, label='äººæ°”çº¿', alpha=0.8)

# æ·»åŠ ç½®ä¿¡å¸¦ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
# ax.fill_between(age_range, judge_lower, judge_upper, alpha=0.2, color='blue')
# ax.fill_between(age_range, fan_lower, fan_upper, alpha=0.2, color='red')

# æ ‡æ³¨æœ€ä¼˜å¹´é¾„
judge_optimal_age = -judge_age_coef / (2 * judge_age_sq_coef)
fan_optimal_age = -fan_age_coef / (2 * fan_age_sq_coef)

ax.axvline(x=judge_optimal_age, color='blue', linestyle='--', alpha=0.7,
          label=f'æŠ€æœ¯çº¿æœ€ä¼˜å¹´é¾„: {judge_optimal_age:.1f}å²')
ax.axvline(x=fan_optimal_age, color='red', linestyle='--', alpha=0.7,
          label=f'äººæ°”çº¿æœ€ä¼˜å¹´é¾„: {fan_optimal_age:.1f}å²')

ax.set_xlabel('å¹´é¾„')
ax.set_ylabel('é¢„æœŸæ•ˆåº”')
ax.set_title('å¹´é¾„å¯¹æŠ€æœ¯è¡¨ç°vsäººæ°”è¡¨ç°çš„éçº¿æ€§å½±å“')
ax.legend()
ax.grid(True, alpha=0.3)

# æ·»åŠ å®é™…æ•°æ®ç‚¹çš„åˆ†å¸ƒï¼ˆå¹´é¾„ç›´æ–¹å›¾ï¼‰
ax2 = ax.twinx()
# ä»åŸå§‹æ•°æ®è·å–å¹´é¾„åˆ†å¸ƒ
ax2.hist(actual_ages, bins=20, alpha=0.3, color='gray', density=True)
ax2.set_ylabel('é€‰æ‰‹å¹´é¾„åˆ†å¸ƒå¯†åº¦', alpha=0.7)
```

**å…³é”®è§£è¯»ç‚¹**:
- å¹´é¾„æ•ˆåº”çš„å€’Uå‹æ›²çº¿
- æŠ€æœ¯çº¿å’Œäººæ°”çº¿çš„æœ€ä¼˜å¹´é¾„å·®å¼‚
- å®é™…é€‰æ‰‹å¹´é¾„åˆ†å¸ƒä¸ç†è®ºæœ€ä¼˜çš„å¯¹æ¯”

---

### å›¾3-4: èŒä¸šç±»åˆ«å½±å“çƒ­å›¾ (Industry Category Impact Heatmap)
**æ–‡ä»¶å**: `q3_industry_impact_heatmap.{tiff,eps}`

**ç›®çš„**: å±•ç¤ºä¸åŒèŒä¸šèƒŒæ™¯åœ¨æŠ€æœ¯vsäººæ°”ä¸Šçš„å·®å¼‚åŒ–å½±å“

**æ•°æ®æº**:
- ç­›é€‰æ‰€æœ‰`C(industry)[T.*]`ç³»æ•°

**å›¾è¡¨è®¾è®¡**:
```python
fig, ax = plt.subplots(figsize=(12, 8))

# æå–èŒä¸šç±»åˆ«ç³»æ•°
industry_terms = [term for term in coeffs['term'].unique() 
                 if term.startswith('C(industry)[T.')]

industry_matrix = []
industry_labels = []

for term in industry_terms:
    industry_name = term.replace('C(industry)[T.', '').replace(']', '')
    judge_coef = judge_data[judge_data['term'] == term]['estimate']
    fan_coef = fan_data[fan_data['term'] == term]['estimate']
    
    if len(judge_coef) > 0 and len(fan_coef) > 0:
        industry_matrix.append([judge_coef.iloc[0], fan_coef.iloc[0]])
        industry_labels.append(industry_name)

industry_matrix = np.array(industry_matrix)

# ç»˜åˆ¶çƒ­å›¾
im = ax.imshow(industry_matrix.T, cmap='RdBu_r', aspect='auto')

# è®¾ç½®æ ‡ç­¾
ax.set_xticks(range(len(industry_labels)))
ax.set_xticklabels(industry_labels, rotation=45, ha='right')
ax.set_yticks([0, 1])
ax.set_yticklabels(['æŠ€æœ¯çº¿', 'äººæ°”çº¿'])

# æ·»åŠ æ•°å€¼æ ‡æ³¨
for i in range(len(industry_labels)):
    for j in range(2):
        text = ax.text(i, j, f'{industry_matrix[i, j]:.3f}',
                      ha="center", va="center", color="black", fontweight='bold')

# æ·»åŠ é¢œè‰²æ¡
cbar = plt.colorbar(im)
cbar.set_label('ç³»æ•°ä¼°è®¡å€¼')

ax.set_title('ä¸åŒèŒä¸šèƒŒæ™¯çš„æŠ€æœ¯vsäººæ°”å½±å“å¯¹æ¯”\nçº¢è‰²=è´Ÿå½±å“ï¼Œè“è‰²=æ­£å½±å“')
plt.tight_layout()
```

**å…³é”®è§£è¯»ç‚¹**:
- è¿åŠ¨å‘˜åœ¨æŠ€æœ¯çº¿ä¸Šä¼˜åŠ¿æ˜æ˜¾
- æ¼”å‘˜/æ­Œæ‰‹åœ¨äººæ°”çº¿ä¸Šå¯èƒ½æ›´æœ‰ä¼˜åŠ¿
- æŸäº›èŒä¸šçš„"åŒåˆƒå‰‘"æ•ˆåº”

---

## ğŸš€ **ç‚«æŠ€å¯¹æ¯”å›¾è¡¨**

### å›¾3-5: æ··åˆæ•ˆåº” vs æœºå™¨å­¦ä¹ æ–¹æ³•å¯¹æ¯” (Mixed Effects vs ML Comparison)
**æ–‡ä»¶å**: `q3_mixed_effects_vs_ml.{tiff,eps}`

**ç›®çš„**: å±•ç¤ºç»Ÿè®¡å»ºæ¨¡ç›¸å¯¹äºçº¯æœºå™¨å­¦ä¹ æ–¹æ³•çš„ä¼˜åŠ¿

**æ•°æ®æº**:
- ä¸»çº¿: Q3æ··åˆæ•ˆåº”æ¨¡å‹ç»“æœ
- å¯¹ç…§: `outputs/tables/showcase/mcm2026c_q3_ml_fan_index_baselines_cv_summary.csv`
- æ·±åº¦å­¦ä¹ : `outputs/tables/showcase/mcm2026c_q3_dl_fan_regression_nets_summary.csv`

**å›¾è¡¨è®¾è®¡**:
```python
fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(16, 12))

# å­å›¾1: é¢„æµ‹æ€§èƒ½å¯¹æ¯”
methods = ['æ··åˆæ•ˆåº”æ¨¡å‹', 'Ridgeå›å½’', 'MLP', 'ResNet', 'Attention Net']
r2_scores = [mixed_effects_r2, ridge_r2, mlp_r2, resnet_r2, attention_r2]
colors = ['gold', 'lightblue', 'lightgreen', 'lightcoral', 'plum']

bars = ax1.bar(methods, r2_scores, color=colors, alpha=0.8)
ax1.set_ylabel('RÂ² å¾—åˆ†')
ax1.set_title('é¢„æµ‹æ€§èƒ½å¯¹æ¯” (ç²‰ä¸æŠ•ç¥¨æŒ‡æ•°)')
ax1.tick_params(axis='x', rotation=45)
ax1.grid(True, alpha=0.3)

# å­å›¾2: å¯è§£é‡Šæ€§å¾—åˆ†
interpretability_scores = [1.0, 0.8, 0.3, 0.1, 0.2]  # ä¸»è§‚è¯„åˆ†
ax2.bar(methods, interpretability_scores, color=colors, alpha=0.8)
ax2.set_ylabel('å¯è§£é‡Šæ€§å¾—åˆ†')
ax2.set_title('æ¨¡å‹å¯è§£é‡Šæ€§å¯¹æ¯”')
ax2.tick_params(axis='x', rotation=45)
ax2.grid(True, alpha=0.3)

# å­å›¾3: ä¸ç¡®å®šæ€§é‡åŒ–èƒ½åŠ›
uncertainty_scores = [1.0, 0.6, 0.4, 0.2, 0.3]  # åŸºäºç½®ä¿¡åŒºé—´ç­‰
ax3.bar(methods, uncertainty_scores, color=colors, alpha=0.8)
ax3.set_ylabel('ä¸ç¡®å®šæ€§é‡åŒ–å¾—åˆ†')
ax3.set_title('ä¸ç¡®å®šæ€§é‡åŒ–èƒ½åŠ›')
ax3.tick_params(axis='x', rotation=45)
ax3.grid(True, alpha=0.3)

# å­å›¾4: ç»¼åˆè¯„åˆ†é›·è¾¾å›¾
categories = ['é¢„æµ‹æ€§èƒ½', 'å¯è§£é‡Šæ€§', 'ä¸ç¡®å®šæ€§é‡åŒ–', 'è®¡ç®—æ•ˆç‡', 'ç¨³å¥æ€§']
mixed_effects_scores = [0.85, 1.0, 1.0, 0.9, 0.95]
ml_avg_scores = [0.75, 0.4, 0.3, 0.7, 0.6]

angles = np.linspace(0, 2*np.pi, len(categories), endpoint=False).tolist()
angles += angles[:1]  # é—­åˆ

mixed_effects_scores += mixed_effects_scores[:1]
ml_avg_scores += ml_avg_scores[:1]

ax4.plot(angles, mixed_effects_scores, 'o-', linewidth=2, label='æ··åˆæ•ˆåº”æ¨¡å‹', color='gold')
ax4.fill(angles, mixed_effects_scores, alpha=0.25, color='gold')
ax4.plot(angles, ml_avg_scores, 'o-', linewidth=2, label='æœºå™¨å­¦ä¹ å¹³å‡', color='lightblue')
ax4.fill(angles, ml_avg_scores, alpha=0.25, color='lightblue')

ax4.set_xticks(angles[:-1])
ax4.set_xticklabels(categories)
ax4.set_ylim(0, 1)
ax4.set_title('ç»¼åˆèƒ½åŠ›å¯¹æ¯”')
ax4.legend()
ax4.grid(True)

plt.tight_layout()
```

**å…³é”®è§£è¯»ç‚¹**:
- æ··åˆæ•ˆåº”æ¨¡å‹åœ¨å¯è§£é‡Šæ€§å’Œä¸ç¡®å®šæ€§é‡åŒ–ä¸Šçš„æ˜¾è‘—ä¼˜åŠ¿
- æœºå™¨å­¦ä¹ æ–¹æ³•åœ¨æŸäº›é¢„æµ‹ä»»åŠ¡ä¸Šçš„ç«äº‰åŠ›
- ä¸åŒæ–¹æ³•çš„é€‚ç”¨åœºæ™¯åˆ†æ

---

### å›¾3-6: ä¸ç¡®å®šæ€§ä¼ æ’­æ•ˆæœå›¾ (Uncertainty Propagation Effects)
**æ–‡ä»¶å**: `q3_uncertainty_propagation.{tiff,eps}`

**ç›®çš„**: å±•ç¤ºQ1ä¸ç¡®å®šæ€§å¦‚ä½•å½±å“Q3çš„ç³»æ•°ä¼°è®¡ï¼ŒéªŒè¯ä¸ç¡®å®šæ€§ä¼ æ’­çš„å¿…è¦æ€§

**æ•°æ®æº**:
- å¯¹æ¯”ä¸åŒ`n_refits`è®¾ç½®ä¸‹çš„ç³»æ•°ä¼°è®¡
- `outputs/tables/showcase/mcm2026c_showcase_q3_refit_grid.csv`

**å›¾è¡¨è®¾è®¡**:
```python
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 8))

# å·¦å›¾: ç½®ä¿¡åŒºé—´å®½åº¦éšé‡æ‹Ÿåˆæ¬¡æ•°çš„å˜åŒ–
n_refits_values = [1, 10, 15, 30, 50]
ci_widths_age = [get_ci_width('age', n) for n in n_refits_values]
ci_widths_is_us = [get_ci_width('is_us', n) for n in n_refits_values]

ax1.plot(n_refits_values, ci_widths_age, 'o-', label='å¹´é¾„ç³»æ•°', linewidth=2, markersize=8)
ax1.plot(n_refits_values, ci_widths_is_us, 's-', label='æœ¬åœŸä¼˜åŠ¿ç³»æ•°', linewidth=2, markersize=8)
ax1.set_xlabel('é‡æ‹Ÿåˆæ¬¡æ•°')
ax1.set_ylabel('ç½®ä¿¡åŒºé—´å®½åº¦')
ax1.set_title('ä¸ç¡®å®šæ€§ä¼ æ’­å¯¹ç³»æ•°ä¼°è®¡çš„å½±å“')
ax1.legend()
ax1.grid(True, alpha=0.3)

# å³å›¾: ç³»æ•°ç¨³å®šæ€§åˆ†æ
ax2.errorbar(range(len(key_coefficients)), 
            [coef_means[coef] for coef in key_coefficients],
            yerr=[coef_stds[coef] for coef in key_coefficients],
            fmt='o', capsize=5, capthick=2, markersize=8)

ax2.set_xticks(range(len(key_coefficients)))
ax2.set_xticklabels(key_coefficients, rotation=45, ha='right')
ax2.set_ylabel('ç³»æ•°ä¼°è®¡å€¼')
ax2.set_title('å…³é”®ç³»æ•°çš„ç¨³å®šæ€§åˆ†æ\n(åŸºäºå¤šæ¬¡é‡æ‹Ÿåˆ)')
ax2.axhline(y=0, color='red', linestyle='--', alpha=0.7)
ax2.grid(True, alpha=0.3)
```

**å…³é”®è§£è¯»ç‚¹**:
- ä¸ç¡®å®šæ€§ä¼ æ’­å¯¹ç½®ä¿¡åŒºé—´çš„å½±å“
- ä¸åŒç³»æ•°å¯¹ä¸ç¡®å®šæ€§çš„æ•æ„Ÿç¨‹åº¦
- éªŒè¯ç»Ÿè®¡æ¨æ–­çš„ç¨³å¥æ€§

---

## ğŸ“‹ **æ·±åº¦åˆ†æå›¾è¡¨**

### å›¾3-7: Pro Danceréšæœºæ•ˆåº”åˆ†æ (Pro Dancer Random Effects)
**æ–‡ä»¶å**: `q3_pro_dancer_effects.{tiff,eps}`

**ç›®çš„**: å±•ç¤ºèŒä¸šèˆè€…çš„ä¸ªä½“å·®å¼‚å¯¹é€‰æ‰‹è¡¨ç°çš„å½±å“

**æ•°æ®æº**:
- éœ€è¦ä»æ··åˆæ•ˆåº”æ¨¡å‹ä¸­æå–éšæœºæ•ˆåº”
- æˆ–è€…é€šè¿‡å›ºå®šæ•ˆåº”æ¨¡å‹åˆ†æpro_nameç³»æ•°

**ä¸»çº¿ç°çŠ¶è¯´æ˜ï¼ˆé‡è¦ï¼‰**:

 å½“å‰ä¸»çº¿è¾“å‡º `outputs/tables/mcm2026c_q3_impact_analysis_coeffs.csv` ä¸åŒ…å« pro ç»´åº¦çš„éšæœºæ•ˆåº”/ä¸ªä½“æ•ˆåº”è½ç›˜ç»“æœã€‚

 è‹¥è¦è®©è¯¥å›¾è¿›å…¥å¯å¤ç°ä¸»çº¿ï¼Œå»ºè®®åç»­æ–°å¢äº§ç‰©ï¼ˆåç»­å®ç°ï¼‰ï¼š

 - `outputs/tables/mcm2026c_q3_pro_random_effects.csv`
   - å­—æ®µç¤ºä¾‹ï¼š`pro_name, effect, se, ci_low, ci_high`

**å›¾è¡¨è®¾è®¡**:
```python
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 12))

# ä¸Šå›¾: Top/Bottom Pro Dancersæ•ˆåº”
top_pros = pro_effects.nlargest(10)
bottom_pros = pro_effects.nsmallest(10)

y_pos_top = np.arange(len(top_pros))
y_pos_bottom = np.arange(len(bottom_pros))

ax1.barh(y_pos_top, top_pros.values, color='green', alpha=0.7)
ax1.set_yticks(y_pos_top)
ax1.set_yticklabels(top_pros.index)
ax1.set_xlabel('Pro Danceræ•ˆåº” (æ­£å‘)')
ax1.set_title('Top 10 èŒä¸šèˆè€…æ•ˆåº”')
ax1.grid(True, alpha=0.3)

# ä¸‹å›¾: Bottom Pro Dancers
ax2.barh(y_pos_bottom, bottom_pros.values, color='red', alpha=0.7)
ax2.set_yticks(y_pos_bottom)
ax2.set_yticklabels(bottom_pros.index)
ax2.set_xlabel('Pro Danceræ•ˆåº” (è´Ÿå‘)')
ax2.set_title('Bottom 10 èŒä¸šèˆè€…æ•ˆåº”')
ax2.grid(True, alpha=0.3)

plt.tight_layout()
```

**å…³é”®è§£è¯»ç‚¹**:
- èŒä¸šèˆè€…çš„ä¸ªä½“å·®å¼‚æ˜¾è‘—
- "é‡‘ç‰Œæ­æ¡£"vs"å›°éš¾æ­æ¡£"çš„è¯†åˆ«
- ä¸ºé€‰æ‰‹é…å¯¹ç­–ç•¥æä¾›ä¾æ®

---

### å›¾3-8: äº¤äº’æ•ˆåº”åˆ†æå›¾ (Interaction Effects Analysis)
**æ–‡ä»¶å**: `q3_interaction_effects.{tiff,eps}`

**ç›®çš„**: æ¢ç´¢å…³é”®å› ç´ ä¹‹é—´çš„äº¤äº’æ•ˆåº”

**æ•°æ®æº**:
- æ‰©å±•æ¨¡å‹åŒ…å«äº¤äº’é¡¹
- é‡ç‚¹åˆ†æageÃ—industry, is_usÃ—industryç­‰

**ä¸»çº¿ç°çŠ¶è¯´æ˜ï¼ˆé‡è¦ï¼‰**:

 å½“å‰ä¸»çº¿è¾“å‡ºæœªè½ç›˜â€œäº¤äº’é¡¹ç³»æ•°/è¾¹é™…æ•ˆåº”â€ç»“æœï¼Œå› æ­¤è¯¥å›¾åªèƒ½ä½œä¸ºæœªæ¥å·¥ä½œ/é™„å½•ç¤ºæ„ã€‚

**å›¾è¡¨è®¾è®¡**:
```python
fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(16, 12))

# å­å›¾1: å¹´é¾„Ã—èŒä¸šäº¤äº’æ•ˆåº”
industries = ['Actor', 'Athlete', 'Singer', 'TV Personality']
age_groups = ['Young (18-30)', 'Middle (31-45)', 'Senior (46+)']

interaction_matrix = np.array([
    [actor_young_effect, actor_middle_effect, actor_senior_effect],
    [athlete_young_effect, athlete_middle_effect, athlete_senior_effect],
    # ... å…¶ä»–èŒä¸š
])

im1 = ax1.imshow(interaction_matrix, cmap='RdBu_r', aspect='auto')
ax1.set_xticks(range(len(age_groups)))
ax1.set_xticklabels(age_groups)
ax1.set_yticks(range(len(industries)))
ax1.set_yticklabels(industries)
ax1.set_title('å¹´é¾„Ã—èŒä¸šäº¤äº’æ•ˆåº” (æŠ€æœ¯çº¿)')

# å­å›¾2-4: å…¶ä»–äº¤äº’æ•ˆåº”åˆ†æ...
```

**å…³é”®è§£è¯»ç‚¹**:
- å¹´è½»è¿åŠ¨å‘˜vså¹´é•¿æ¼”å‘˜çš„ä¸åŒä¼˜åŠ¿
- æœ¬åœŸé€‰æ‰‹åœ¨ä¸åŒèŒä¸šä¸­çš„è¡¨ç°å·®å¼‚
- å¤æ‚äº¤äº’æ¨¡å¼çš„è¯†åˆ«

---

## ğŸ“‹ **æŠ€æœ¯å®ç°è§„èŒƒ**

### ç³»æ•°æå–å’Œå¤„ç†
```python
def extract_coefficients(coeffs_df, outcome_type):
    """æå–ç‰¹å®šç»“æœç±»å‹çš„ç³»æ•°"""
    return coeffs_df[coeffs_df['outcome'] == outcome_type].copy()

def calculate_effect_size(coef, std_x):
    """è®¡ç®—æ ‡å‡†åŒ–æ•ˆåº”å¤§å°"""
    return coef * std_x

def format_significance(p_value):
    """æ ¼å¼åŒ–æ˜¾è‘—æ€§æ ‡è®°"""
    if p_value < 0.001:
        return '***'
    elif p_value < 0.01:
        return '**'
    elif p_value < 0.05:
        return '*'
    else:
        return ''
```

### é¢œè‰²æ–¹æ¡ˆ
- **æŠ€æœ¯çº¿**: è“è‰²ç³» (#1f77b4, #aec7e8)
- **äººæ°”çº¿**: çº¢è‰²ç³» (#d62728, #ff9896)
- **æ˜¾è‘—æ€§**: é‡‘è‰²æ ‡è®° (#ffd700)
- **ç½®ä¿¡åŒºé—´**: åŠé€æ˜å¡«å……

### ç»Ÿè®¡æŠ¥å‘Šè§„èŒƒ
```python
def format_coefficient_table(coeffs_df):
    """æ ¼å¼åŒ–ç³»æ•°è¡¨æ ¼ç”¨äºå›¾è¡¨æ ‡æ³¨"""
    coeffs_df['formatted'] = coeffs_df.apply(
        lambda row: f"{row['estimate']:.3f} ({row['ci_low']:.3f}, {row['ci_high']:.3f})",
        axis=1
    )
    return coeffs_df
```

---

## ğŸ¯ **è®ºæ–‡é›†æˆç­–ç•¥**

### ä¸»çº¿è®ºè¯é€»è¾‘
1. **å›¾3-1**: æ ¸å¿ƒå‘ç°å±•ç¤ºï¼ˆæŠ€æœ¯vsäººæ°”å·®å¼‚ï¼‰
2. **å›¾3-2**: å…³é”®å› ç´ çªå‡ºï¼ˆæ”¿ç­–å«ä¹‰ï¼‰
3. **å›¾3-3**: éçº¿æ€§æ•ˆåº”è§£é‡Šï¼ˆå¹´é¾„æœ€ä¼˜åŒ–ï¼‰
4. **å›¾3-4**: èŒä¸šå·®å¼‚åˆ†æï¼ˆç»†åˆ†å¸‚åœºï¼‰

### æ–¹æ³•éªŒè¯ç­–ç•¥
1. **å›¾3-5**: æ–¹æ³•é€‰æ‹©åˆç†æ€§éªŒè¯
2. **å›¾3-6**: ä¸ç¡®å®šæ€§ä¼ æ’­å¿…è¦æ€§éªŒè¯

### æ·±åº¦åˆ†æç­–ç•¥
1. **å›¾3-7**: Pro Danceræ•ˆåº”ï¼ˆå®è·µæŒ‡å¯¼ï¼‰
2. **å›¾3-8**: äº¤äº’æ•ˆåº”ï¼ˆå¤æ‚æ¨¡å¼ï¼‰

### ä¸å…¶ä»–é¢˜ç›®çš„è¡”æ¥
- **â† Q1**: åŸºäºQ1çš„ä¸ç¡®å®šæ€§é‡åŒ–ç»“æœ
- **â† Q2**: æœºåˆ¶å·®å¼‚ä¸ºå½±å“å› ç´ åˆ†ææä¾›åŠ¨æœº
- **â†’ Q4**: å½±å“å› ç´ åˆ†æä¸ºæ–°æœºåˆ¶è®¾è®¡æä¾›ç†è®ºåŸºç¡€

---

## âš ï¸ **æ³¨æ„äº‹é¡¹ä¸é£é™©æ§åˆ¶**

### ç³»æ•°è§£é‡Šå‡†ç¡®æ€§
- æ˜ç¡®åŒºåˆ†æ ‡å‡†åŒ–å’Œéæ ‡å‡†åŒ–ç³»æ•°
- æ­£ç¡®è§£é‡Šäº¤äº’é¡¹çš„å«ä¹‰
- é¿å…å› æœæ¨æ–­çš„è¿‡åº¦è§£è¯»

### å¤šé‡æ¯”è¾ƒæ§åˆ¶
- å¯¹å¤šä¸ªç³»æ•°çš„æ˜¾è‘—æ€§æ£€éªŒè¿›è¡Œæ ¡æ­£
- ä½¿ç”¨FDRæˆ–Bonferroniæ ¡æ­£
- åœ¨å›¾æ³¨ä¸­è¯´æ˜æ ¡æ­£æ–¹æ³•

### æ¨¡å‹å‡è®¾éªŒè¯
- æ£€æŸ¥æ®‹å·®çš„æ­£æ€æ€§å’ŒåŒæ–¹å·®æ€§
- éªŒè¯éšæœºæ•ˆåº”çš„åˆç†æ€§
- æŠ¥å‘Šæ¨¡å‹è¯Šæ–­ç»“æœ

è¿™ä¸ªQ3å¯è§†åŒ–è§„åˆ’ç¡®ä¿èƒ½å¤Ÿï¼š
1. **æ¸…æ™°å±•ç¤ºæ ¸å¿ƒå‘ç°**ï¼šæŠ€æœ¯çº¿vsäººæ°”çº¿çš„å·®å¼‚æœºåˆ¶
2. **æä¾›å®è·µæŒ‡å¯¼ä»·å€¼**ï¼šä¸ºé€‰æ‰‹ç­–ç•¥å’Œåˆ¶ä½œæ–¹å†³ç­–æä¾›ä¾æ®
3. **éªŒè¯æ–¹æ³•è®ºä¼˜åŠ¿**ï¼šå±•ç¤ºç»Ÿè®¡å»ºæ¨¡ç›¸å¯¹äºæœºå™¨å­¦ä¹ çš„ä¼˜åŠ¿
4. **ä¿æŒå­¦æœ¯ä¸¥è°¨æ€§**ï¼šæ­£ç¡®çš„ç»Ÿè®¡æ¨æ–­å’Œä¸ç¡®å®šæ€§é‡åŒ–