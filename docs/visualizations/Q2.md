# Q2 å¯è§†åŒ–è§„åˆ’æ–‡æ¡£ï¼šåäº‹å®æœºåˆ¶å¯¹æ¯”ä¸Judge Saveåˆ†æ

**ç›®æ ‡**: é€šè¿‡å¯è§†åŒ–å±•ç¤ºQ2çš„æ ¸å¿ƒè´¡çŒ®â€”â€”åäº‹å®ä»¿çœŸå¯¹æ¯”ä¸åŒæ·˜æ±°æœºåˆ¶ï¼Œé‡åŒ–æœºåˆ¶å·®å¼‚å¯¹ç»“æœçš„å½±å“

## ğŸ“Š **æ ¸å¿ƒå¯è§†åŒ–ç›®æ ‡**


### 1. **é‡åŒ–æœºåˆ¶å·®å¼‚**: å±•ç¤ºPercent vs Rankæœºåˆ¶åœ¨å®é™…åº”ç”¨ä¸­çš„å·®å¼‚ç¨‹åº¦
### 2. **Judge Saveæ•ˆæœ**: å¯è§†åŒ–Judge Saveæœºåˆ¶å¯¹æ·˜æ±°è·¯å¾„çš„å½±å“
### 3. **äº‰è®®æ¡ˆä¾‹åˆ†æ**: é‡ç‚¹å±•ç¤ºBobby Bonesç­‰äº‰è®®æ¡ˆä¾‹çš„æœºåˆ¶æ•æ„Ÿæ€§
### 4. **è·¨å­£åº¦ç¨³å®šæ€§**: å±•ç¤ºæœºåˆ¶å·®å¼‚åœ¨ä¸åŒèµ›å­£çš„ä¸€è‡´æ€§å’Œå˜å¼‚æ€§

---

## âœ… ä¸»çº¿å£å¾„çº¦æŸï¼ˆå†™è¿›è®ºæ–‡æ­£æ–‡å¿…é¡»éµå®ˆï¼‰

- **ä¸»çº¿å›¾è¡¨**åªå…è®¸ä½¿ç”¨ï¼š
  - `data/processed/*.csv`
  - `outputs/tables/*.csv`
  - `outputs/predictions/*.csv`
- `outputs/tables/showcase/*` ä»…ç”¨äº**é™„å½•å¯¹ç…§/ç‚«æŠ€**ã€‚

é¢˜é¢è¦æ±‚ï¼ˆ`mcm2026c/2026_MCM_Problem_C.md`ï¼‰ä¸­ï¼ŒQ2 çš„æ ¸å¿ƒæ˜¯ï¼š

- å¯¹æ¯ä¸ª season åŒæ—¶åº”ç”¨ rank ä¸ percent çš„ç»„åˆæ–¹å¼å¹¶å¯¹æ¯”ã€‚
- é’ˆå¯¹äº‰è®®é€‰æ‰‹/èµ›å­£è®¨è®ºâ€œæ˜¯å¦ä¼šåŒæ ·ç»“æœâ€ï¼Œä»¥åŠ Judge Saveï¼ˆbottom-2 åè¯„å§”æ·˜æ±°å…¶ä¸€ï¼‰çš„å½±å“ã€‚

---

## ğŸ¯ **ä¸»çº¿å›¾è¡¨æ¸…å•**


### å›¾2-1: æœºåˆ¶å·®å¼‚å‘¨æ•°åˆ†å¸ƒå›¾ (Mechanism Difference Distribution)
**æ–‡ä»¶å**: `q2_mechanism_difference_distribution.{tiff,eps}`

**ç›®çš„**: ä¸€çœ¼çœ‹å‡ºPercent vs Rankæœºåˆ¶åœ¨å¤šå°‘å‘¨äº§ç”Ÿä¸åŒçš„æ·˜æ±°ç»“æœ

**æ•°æ®æº**:

- `outputs/tables/mcm2026c_q2_mechanism_comparison.csv`
- å­—æ®µ: `season, diff_weeks_percent_vs_rank, n_exit_weeks`

**å›¾è¡¨è®¾è®¡**:

- å·¦å›¾ï¼š`diff_weeks_percent_vs_rank` çš„ç›´æ–¹å›¾ï¼ˆè·¨èµ›å­£åˆ†å¸ƒï¼‰
- å³å›¾ï¼š`diff_rate = diff_weeks_percent_vs_rank / n_exit_weeks` çš„æ•£ç‚¹å›¾ï¼ˆæŒ‰ seasonï¼‰

---

### å›¾2-2: Judge Saveæ•ˆæœå¯¹æ¯”å›¾ (Judge Save Impact Comparison)
**æ–‡ä»¶å**: `q2_judge_save_impact.{tiff,eps}`

**ç›®çš„**: å±•ç¤ºJudge Saveæœºåˆ¶å¯¹match rateçš„å½±å“ï¼Œé‡åŒ–"è¯„å§”æ•‘æ´"çš„æ•ˆæœ

**æ•°æ®æº**:
- `outputs/tables/mcm2026c_q2_mechanism_comparison.csv`
- å­—æ®µ: `match_rate_percent, match_rate_rank, match_rate_percent_judge_save, match_rate_rank_judge_save`

**å›¾è¡¨è®¾è®¡**:
```python
fig, ax = plt.subplots(figsize=(14, 8))

seasons = data['season']
x = np.arange(len(seasons))
width = 0.2

# å››ç»„å¹¶åˆ—æŸ±çŠ¶å›¾
bars1 = ax.bar(x - 1.5*width, data['match_rate_percent'], width, 
               label='Percent (æ ‡å‡†)', color='lightblue', alpha=0.8)
bars2 = ax.bar(x - 0.5*width, data['match_rate_percent_judge_save'], width,
               label='Percent + Judge Save', color='darkblue', alpha=0.8)
bars3 = ax.bar(x + 0.5*width, data['match_rate_rank'], width,
               label='Rank (æ ‡å‡†)', color='lightcoral', alpha=0.8)
bars4 = ax.bar(x + 1.5*width, data['match_rate_rank_judge_save'], width,
               label='Rank + Judge Save', color='darkred', alpha=0.8)

ax.set_xlabel('èµ›å­£')
ax.set_ylabel('Match Rate (åŒ¹é…ç‡)')
ax.set_title('Judge Save å¯¹ä¸åŒæœºåˆ¶çš„å½±å“\n(å•æ·˜æ±°å‘¨åŒ¹é…ç‡å¯¹æ¯”)')
ax.set_xticks(x[::2])  # æ¯éš”ä¸€ä¸ªèµ›å­£æ˜¾ç¤ºæ ‡ç­¾
ax.set_xticklabels(seasons[::2])
ax.legend()
ax.grid(True, alpha=0.3)
```
### å›¾2-3: äº‰è®®èµ›å­£çƒ­å›¾ (Controversial Seasons Heatmap)
**æ–‡ä»¶å**: `q2_controversial_seasons_heatmap.{tiff,eps}`

**ç›®çš„**: è¯†åˆ«å’Œå±•ç¤ºæœºåˆ¶æ•æ„Ÿçš„äº‰è®®èµ›å­£ï¼Œä¸ºæ¡ˆä¾‹åˆ†ææä¾›ä¾æ®

**æ•°æ®æº**:
- `outputs/tables/mcm2026c_q2_mechanism_comparison.csv`
- è®¡ç®—å¤šä¸ªäº‰è®®æŒ‡æ ‡çš„ç»¼åˆçƒ­å›¾

**å›¾è¡¨è®¾è®¡**:
```python
fig, ax = plt.subplots(figsize=(16, 10))

# æ„å»ºäº‰è®®æŒ‡æ ‡çŸ©é˜µ
controversy_metrics = pd.DataFrame({
    'Season': data['season'],
    'æœºåˆ¶å·®å¼‚å‘¨æ•°': data['diff_weeks_percent_vs_rank'],
    'PercentåŒ¹é…ç‡': data['match_rate_percent'],
    'RankåŒ¹é…ç‡': data['match_rate_rank'],
    'Judge Saveå½±å“': (data['match_rate_percent'] - data['match_rate_percent_judge_save']),
    'ç²‰ä¸-è¯„å§”åˆ†æ­§': data['mean_fan_share_observed'] - data['mean_judge_pct_observed']
})

# æ ‡å‡†åŒ–æ•°æ®ç”¨äºçƒ­å›¾
controversy_normalized = controversy_metrics.set_index('Season')
controversy_normalized = (controversy_normalized - controversy_normalized.mean()) / controversy_normalized.std()

# ç»˜åˆ¶çƒ­å›¾
sns.heatmap(controversy_normalized.T, cmap='RdBu_r', center=0, 
           annot=False, fmt='.1f', cbar_kws={'label': 'æ ‡å‡†åŒ–å¾—åˆ†'})
ax.set_title('äº‰è®®èµ›å­£è¯†åˆ«çƒ­å›¾\nçº¢è‰²=é«˜äº‰è®®ï¼Œè“è‰²=ä½äº‰è®®')
ax.set_xlabel('èµ›å­£')
ax.set_ylabel('äº‰è®®æŒ‡æ ‡')

# æ ‡æ³¨ç‰¹æ®Šèµ›å­£ï¼ˆå¦‚S27 Bobby Bonesï¼‰
if 27 in controversy_metrics['Season'].values:
    s27_idx = controversy_metrics[controversy_metrics['Season'] == 27].index[0]
    ax.axvline(x=s27_idx+0.5, color='gold', linewidth=3, alpha=0.8)
    ax.text(s27_idx+0.5, -0.5, 'S27\nBobby Bones', ha='center', 
           bbox=dict(boxstyle='round', facecolor='gold', alpha=0.7))
```
### å›¾2-4: ç²‰ä¸-è¯„å§”åˆ†æ­§æ•£ç‚¹å›¾ (Fan-Judge Divergence Scatter)
**æ–‡ä»¶å**: `q2_fan_judge_divergence.{tiff,eps}`

**ç›®çš„**: å±•ç¤ºç²‰ä¸åå¥½ä¸è¯„å§”åå¥½çš„åˆ†æ­§ç¨‹åº¦ï¼Œè§£é‡Šæœºåˆ¶å·®å¼‚çš„æ ¹æœ¬åŸå› 

**æ•°æ®æº**:
- `outputs/tables/mcm2026c_q2_mechanism_comparison.csv`
- å­—æ®µ: `mean_fan_share_observed, mean_judge_pct_observed, diff_weeks_percent_vs_rank`

**å›¾è¡¨è®¾è®¡**:
```python
fig, ax = plt.subplots(figsize=(12, 10))

# è®¡ç®—åˆ†æ­§æŒ‡æ ‡
fan_judge_divergence = (data['mean_fan_share_observed'] - data['mean_judge_pct_observed']).abs()

# æ•£ç‚¹å›¾ï¼šåˆ†æ­§ç¨‹åº¦ vs æœºåˆ¶å·®å¼‚
scatter = ax.scatter(fan_judge_divergence, data['diff_weeks_percent_vs_rank'],
                    c=data['season'], cmap='viridis', s=80, alpha=0.7)

# æ·»åŠ è¶‹åŠ¿çº¿
z = np.polyfit(fan_judge_divergence, data['diff_weeks_percent_vs_rank'], 1)
p = np.poly1d(z)
ax.plot(fan_judge_divergence, p(fan_judge_divergence), "r--", alpha=0.8,
        label=f'è¶‹åŠ¿çº¿ (RÂ²={np.corrcoef(fan_judge_divergence, data["diff_weeks_percent_vs_rank"])[0,1]**2:.3f})')

ax.set_xlabel('ç²‰ä¸-è¯„å§”åˆ†æ­§ç¨‹åº¦ |ç²‰ä¸ä»½é¢ - è¯„å§”ä»½é¢|')
ax.set_ylabel('æœºåˆ¶å·®å¼‚å‘¨æ•°')
ax.set_title('ç²‰ä¸-è¯„å§”åˆ†æ­§ vs æœºåˆ¶å·®å¼‚å…³ç³»\né¢œè‰²è¡¨ç¤ºèµ›å­£')

# æ·»åŠ é¢œè‰²æ¡
cbar = plt.colorbar(scatter)
cbar.set_label('èµ›å­£')
ax.legend()
ax.grid(True, alpha=0.3)

# æ ‡æ³¨æç«¯æ¡ˆä¾‹
extreme_seasons = data[data['diff_weeks_percent_vs_rank'] >= 3]['season']
for season in extreme_seasons:
    season_data = data[data['season'] == season].iloc[0]
    ax.annotate(f'S{season}', 
               (fan_judge_divergence[data['season'] == season].iloc[0],
                season_data['diff_weeks_percent_vs_rank']),
               xytext=(5, 5), textcoords='offset points',
               bbox=dict(boxstyle='round,pad=0.3', facecolor='yellow', alpha=0.7))
```
---

## ğŸš€ **ç‚«æŠ€å¯¹æ¯”å›¾è¡¨**


### å›¾2-5: æœºå™¨å­¦ä¹ æœºåˆ¶é¢„æµ‹ç»“æœ (ML Mechanism Prediction Results)
**æ–‡ä»¶å**: `q2_ml_mechanism_prediction.{tiff,eps}`

**å®šä½**: é™„å½•å¯¹ç…§ï¼ˆshowcaseï¼‰ã€‚ä¸ä½œä¸ºé¢˜é¢ä¸»çº¿å¿…é¡»äº¤ä»˜å†…å®¹ã€‚

**æ•°æ®æºï¼ˆshowcaseï¼‰**:

- `outputs/tables/showcase/mcm2026c_q2_ml_mechanism_prediction.csv`
- `outputs/tables/showcase/mcm2026c_q2_ml_feature_importance.csv`

---

### å›¾2-6: åäº‹å®ä»¿çœŸéªŒè¯å›¾ (Counterfactual Simulation Validation)
**æ–‡ä»¶å**: `q2_counterfactual_validation.{tiff,eps}`

**å®šä½**: é™„å½•å¯¹ç…§ã€‚è¯¥å›¾æ›´å¤šæ˜¯â€œå†…éƒ¨ä¸€è‡´æ€§/è‡ªæ£€â€çš„å¯è§†åŒ–ï¼Œä¸ä½œä¸ºé¢˜é¢è¦æ±‚çš„æ ¸å¿ƒè¯æ®.


**æ•°æ®æº**:
- å¯¹æ¯”å®é™…æ·˜æ±°ç»“æœä¸ä»¿çœŸé¢„æµ‹ç»“æœ
- `outputs/tables/mcm2026c_q2_mechanism_comparison.csv`

---

### å›¾2-7: Bobby Bonesæ¡ˆä¾‹åˆ†æ (Bobby Bones Case Study)
**æ–‡ä»¶å**: `q2_bobby_bones_case_study.{tiff,eps}`

**ç›®çš„**: æ·±å…¥åˆ†ææœ€è‘—åçš„äº‰è®®æ¡ˆä¾‹ï¼Œå±•ç¤ºæœºåˆ¶æ•æ„Ÿæ€§
**ä¸»çº¿ç°çŠ¶è¯´æ˜ï¼ˆé‡è¦ï¼‰**:

å½“å‰ä¸»çº¿è¾“å‡º `outputs/tables/mcm2026c_q2_mechanism_comparison.csv` ä¸º season-level æ±‡æ€»è¡¨ï¼Œä¸åŒ…å«â€œé€‰æ‰‹çº§/å‘¨çº§åäº‹å®æ¦‚ç‡â€ã€‚

è‹¥è¦åœ¨è®ºæ–‡æ­£æ–‡å®Œæˆé¢˜é¢è¦æ±‚çš„äº‰è®®æ¡ˆä¾‹å¤ç›˜ï¼ˆS2/S4/S11/S27ï¼‰ï¼Œå»ºè®®å…ˆæ–°å¢ä¸€å¼ å¯å¤ç°äº§ç‰©ï¼ˆåç»­å®ç°ï¼‰ï¼š

- `outputs/tables/mcm2026c_q2_case_studies.csv`
  - ç²’åº¦ï¼š`season, contestant, mechanism`ï¼ˆå¿…è¦æ—¶åŠ å…¥ `week` ç»´åº¦ï¼‰
  - å…¸å‹å­—æ®µï¼š`pr_win, pr_final3, pr_elim_by_week` ç­‰

åœ¨ä¸Šè¿°äº§ç‰©è½ç›˜å‰ï¼Œæœ¬å›¾åªèƒ½ä½œä¸ºâ€œæœªæ¥å·¥ä½œ/é™„å½•ç¤ºæ„â€ï¼Œä¸è¿›å…¥ä¸»çº¿æ­£æ–‡.

---

## ğŸ“‹ **æŠ€æœ¯å®ç°è§„èŒƒ**

### æ•°æ®é¢„å¤„ç†
```python
def prepare_q2_visualization_data():
    """å‡†å¤‡Q2å¯è§†åŒ–æ‰€éœ€çš„æ•°æ®"""
    # è¯»å–ä¸»çº¿ç»“æœ
    q2_results = pd.read_csv('outputs/tables/mcm2026c_q2_mechanism_comparison.csv')
    
    # è®¡ç®—è¡ç”ŸæŒ‡æ ‡
    q2_results['diff_rate'] = (q2_results['diff_weeks_percent_vs_rank'] / 
                              q2_results['n_exit_weeks'])
    q2_results['judge_save_impact_percent'] = (q2_results['match_rate_percent'] - 
                                              q2_results['match_rate_percent_judge_save'])
    q2_results['judge_save_impact_rank'] = (q2_results['match_rate_rank'] - 
                                           q2_results['match_rate_rank_judge_save'])
    
    return q2_results
```

### é¢œè‰²æ–¹æ¡ˆ
- **Percentæœºåˆ¶**: è“è‰²ç³» (#1f77b4, #aec7e8)
- **Rankæœºåˆ¶**: çº¢è‰²ç³» (#d62728, #ff9896)
- **Judge Save**: æ·±è‰²å˜ä½“è¡¨ç¤º
- **äº‰è®®æ ‡è¯†**: é‡‘è‰² (#ffd700)

### ç»Ÿè®¡æ˜¾è‘—æ€§æ ‡æ³¨
```python
def add_significance_stars(ax, x1, x2, y, p_value):
    """æ·»åŠ ç»Ÿè®¡æ˜¾è‘—æ€§æ ‡æ³¨"""
    if p_value < 0.001:
        stars = '***'
    elif p_value < 0.01:
        stars = '**'
    elif p_value < 0.05:
        stars = '*'
    else:
        stars = 'ns'
    
    ax.plot([x1, x2], [y, y], 'k-', linewidth=1)
    ax.text((x1+x2)/2, y+0.01, stars, ha='center', va='bottom')
```

---

## ğŸ¯ **è®ºæ–‡é›†æˆç­–ç•¥**

### ä¸»çº¿è®ºè¯é€»è¾‘
1. **å›¾2-1**: é‡åŒ–æœºåˆ¶å·®å¼‚çš„æ™®éæ€§å’Œåˆ†å¸ƒ
2. **å›¾2-2**: å±•ç¤ºJudge Saveçš„å…·ä½“å½±å“
3. **å›¾2-3**: è¯†åˆ«éœ€è¦é‡ç‚¹å…³æ³¨çš„äº‰è®®èµ›å­£
4. **å›¾2-4**: è§£é‡Šæœºåˆ¶å·®å¼‚çš„æ ¹æœ¬åŸå› 

### æ¡ˆä¾‹åˆ†æç­–ç•¥
1. **å›¾2-7**: Bobby Bonesæ·±åº¦æ¡ˆä¾‹åˆ†æ

### ç‚«æŠ€å±•ç¤ºç­–ç•¥
1. **å›¾2-5**: æœºå™¨å­¦ä¹ æ–¹æ³•éªŒè¯ç»Ÿè®¡åˆ†æ
2. **å›¾2-6**: åäº‹å®ä»¿çœŸæ–¹æ³•éªŒè¯

### ä¸å…¶ä»–é¢˜ç›®çš„è¡”æ¥
- **â† Q1**: åŸºäºQ1çš„ç²‰ä¸æŠ•ç¥¨æ¨æ–­ç»“æœ
- **â†’ Q3**: æœºåˆ¶å·®å¼‚ä¸ºå½±å“å› ç´ åˆ†ææä¾›åŠ¨æœº
- **â†’ Q4**: åäº‹å®åˆ†æä¸ºæ–°æœºåˆ¶è®¾è®¡æä¾›åŸºå‡†

---

## âš ï¸ **æ³¨æ„äº‹é¡¹ä¸é£é™©æ§åˆ¶**

### æ¡ˆä¾‹é€‰æ‹©åŸåˆ™
- ä¼˜å…ˆé€‰æ‹©æœ‰æ˜ç¡®å†å²è®°å½•çš„äº‰è®®æ¡ˆä¾‹
- ç¡®ä¿æ¡ˆä¾‹çš„ä»£è¡¨æ€§å’Œå…¸å‹æ€§
- é¿å…è¿‡åº¦è§£è¯»å•ä¸€æ¡ˆä¾‹

### ç»Ÿè®¡æ£€éªŒè¦æ±‚
- å¯¹æœºåˆ¶å·®å¼‚è¿›è¡Œé…å¯¹tæ£€éªŒ
- æŠ¥å‘Šç½®ä¿¡åŒºé—´è€Œéä»…ç‚¹ä¼°è®¡
- æ§åˆ¶å¤šé‡æ¯”è¾ƒçš„å‡é˜³æ€§ç‡

### å¯è§£é‡Šæ€§ä¿è¯
- æ¯ä¸ªæŒ‡æ ‡éƒ½éœ€è¦æ¸…æ™°çš„å®šä¹‰å’Œè§£é‡Š
- é¿å…ä½¿ç”¨è¿‡äºæŠ€æœ¯æ€§çš„æœ¯è¯­
- æä¾›ç›´è§‚çš„æ•°å€¼è§£é‡Š

è¿™ä¸ªQ2å¯è§†åŒ–è§„åˆ’ç¡®ä¿èƒ½å¤Ÿï¼š
1. **æ¸…æ™°å±•ç¤ºåäº‹å®åˆ†æçš„ä»·å€¼**ï¼šé‡åŒ–æœºåˆ¶é€‰æ‹©çš„å®é™…å½±å“
2. **æä¾›æœ‰åŠ›çš„æ”¿ç­–å»ºè®®åŸºç¡€**ï¼šä¸ºQ4çš„æ–°æœºåˆ¶è®¾è®¡æä¾›ä¾æ®
3. **å±•ç°æ–¹æ³•è®ºçš„ä¸¥è°¨æ€§**ï¼šé€šè¿‡ç‚«æŠ€å¯¹æ¯”éªŒè¯åˆ†æçš„å¯é æ€§
4. **å¢å¼ºè®ºæ–‡çš„è¯´æœåŠ›**ï¼šé€šè¿‡å…·ä½“æ¡ˆä¾‹è®©æŠ½è±¡åˆ†æå˜å¾—å…·ä½“å¯æ„Ÿ